:root {
  --bg-main:#000000;
  --surface:#1a1a1a;
  --surface-border:#2a2a2a;
  --bubble-user:#2a2a2a;
  --bubble-ai:#1f1f1f;
  --text-primary:#ffffff;
  --text-muted:#9ca3af;
  --accent:#FFB906;
  --accent-text:#000000;
  --radius-xl:28px;
  --radius-lg:14px;
  --radius-md:10px;
  --shadow-bar:0 20px 40px rgba(0,0,0,.8);
  --shadow-bubble:0 16px 32px rgba(0,0,0,.7);
  --record-red:#ff4d4d;
  --record-glow:rgba(255,77,77,.7);
}

/* reset */
* {
  box-sizing:border-box;
  -webkit-font-smoothing:antialiased;
}

/* PAGE IS NOW SCROLLABLE LIKE NORMAL */
body {
  margin:0;
  background:var(--bg-main);
  color:var(--text-primary);
  font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Arial;

  /* allow normal scrolling */
  min-height:100dvh;
  display:flex;
  flex-direction:column;
  overflow-y:auto;
}

/* page wrapper centers content and applies max-width */
.page {
  width:100%;
  max-width:900px;
  margin:0 auto;
  padding:24px 16px 120px; /* bottom padding so bubbles don't get hidden behind sticky bar */
  position:relative;
  display:flex;
  flex-direction:column;
}

/* =========================================================
   HERO (landing screen before chat starts)
   ========================================================= */
.hero {
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;

  min-height:50vh; /* simpler: center-ish */
  text-align:center;
  transition:
    opacity .2s ease,
    max-height .2s ease,
    margin .2s ease;
}

.hero-headline {
  margin:0 0 24px;
  font-size:32px;
  font-weight:600;
  color:var(--text-primary);
  line-height:1.2;
}

.hero-composer {
  display:flex;
  justify-content:center;
  width:100%;
}
.hero-composer .composer-bar {
  width:min(760px,90%);
  max-width:760px;
}

/* after chat starts, hide hero */
body.has-started .hero {
  opacity:0;
  max-height:0;
  margin:0;
  overflow:hidden;
}
body.has-started .hero-composer {
  display:none;
}

/* =========================================================
   DOCKED / STICKY COMPOSER
   ========================================================= */

/*
Now it's STICKY instead of FIXED.
This means: it sits at the bottom of the viewport, but it is still
part of the normal flow of the page. As you scroll up, it stays
in view. As you scroll down, you see older messages above it.
*/

.dock-composer {
  position:sticky;
  bottom:0;
  left:0;
  right:0;

  background:var(--bg-main);
  border-top:1px solid var(--surface-border);

  padding:16px 16px 24px;
  display:flex;
  justify-content:center;
  z-index:50;

  /* hidden until chat actually starts */
  visibility:hidden;
  opacity:0;
  pointer-events:none;
  transition:opacity .2s ease;
}

.dock-composer .composer-bar {
  max-width:760px;
  width:100%;
}

body.has-started .dock-composer {
  visibility:visible;
  opacity:1;
  pointer-events:auto;
}

body.hero-mode .dock-composer {
  visibility:hidden;
  opacity:0;
  pointer-events:none;
}

/* =========================================================
   COMPOSER BAR (shared styles for hero + dock)
   ========================================================= */
.composer-bar {
  display:flex;
  align-items:center;
  gap:12px;
  background:var(--surface);
  border:1px solid var(--surface-border);
  border-radius:var(--radius-xl);
  padding:14px 16px;
  box-shadow:var(--shadow-bar);
  color:var(--text-primary);
}

.icon-btn {
  width:40px;
  height:40px;
  display:grid;
  place-items:center;
  border-radius:var(--radius-md);
  border:1px solid transparent;
  background:transparent;
  color:var(--text-primary);
  cursor:pointer;
  transition:.15s ease;
}
.icon-btn svg {
  width:20px;
  height:20px;
  color:currentColor;
}

.attach-btn,
.mic-btn,
.send-btn {
  flex-shrink:0;
}

/* send button (orange) */
.send-btn {
  background:var(--accent);
  color:var(--accent-text);
  border-color:var(--accent);
  border-radius:var(--radius-md);
  font-weight:500;
  min-width:40px;
}
.send-btn:hover {
  filter:brightness(1.05);
}

/* mic idle */
.mic-btn {
  background:transparent;
  border-color:transparent;
  color:var(--text-primary);
}
.mic-btn:hover {
  color:var(--accent);
}

/* mic recording glow */
.mic-wrap.recording {
  box-shadow:
    0 0 16px var(--record-glow),
    0 12px 32px rgba(0,0,0,.9);
  border-radius:var(--radius-md);
  outline:2px solid var(--record-red);
  outline-offset:2px;
}
.mic-btn.recording svg {
  color:var(--record-red);
  filter:drop-shadow(0 0 6px var(--record-glow));
}

/* textarea */
.composer-bar textarea {
  flex:1;
  background:transparent;
  border:0;
  color:var(--text-primary);
  font-size:16px;
  line-height:1.4;
  resize:none;
  outline:0;
  padding:8px 0;
  min-height:24px;
  max-height:140px;
}
.composer-bar textarea::placeholder {
  color:var(--text-muted);
}

/* send / mic swap */
#send,
#send-docked {
  display:none;
}
.typing-mode .right #send,
.typing-mode .right #send-docked {
  display:grid;
}
.typing-mode .right #micWrap,
.typing-mode .right #micWrap-docked {
  display:none;
}

/* =========================================================
   MESSAGES
   ========================================================= */

/*
Now messages are just in the normal flow of the page.
No special flex scroll. No overflow tricks.
The page scrolls normally.
*/

.messages {
  display:flex;
  flex-direction:column;
  gap:16px;
  max-width:760px;
  width:100%;
  margin:0 auto 40px auto;
  position:relative;
  z-index:1;
}

/* bubbles */
.msg {
  max-width:80%;
  padding:12px 16px;
  border-radius:var(--radius-lg);
  font-size:15px;
  line-height:1.4;
  box-shadow:var(--shadow-bubble);
  white-space:pre-wrap;
  word-break:break-word;
  border:1px solid transparent;
  color:var(--text-primary);
}

.msg.user {
  align-self:flex-end;
  background:var(--bubble-user);
  border-color:#3a3a3a;
}

.msg.assistant {
  align-self:flex-start;
  background:var(--bubble-ai);
  border-color:#2a2a2a;
}

.msg.assistant a {
  color:var(--accent);
  text-decoration:underline;
}

.msg.thinking {
  opacity:.6;
  font-style:italic;
}

/* listening bubble */
.msg.system {
  align-self:flex-start;
  background:#111;
  color:var(--accent);
  border:1px solid rgba(255,185,6,.4);
  border-radius:var(--radius-lg);
  font-size:14px;
  font-style:italic;
  line-height:1.4;
  padding:12px 16px;
  display:flex;
  align-items:center;
  gap:6px;
}

.listening-dots::after {
  content:"";
  display:inline-block;
  width:2ch;
  text-align:left;
  color:var(--accent);
  animation:dots-step 1s steps(4,end) infinite;
}
@keyframes dots-step {
  0%   { content:""; }
  25%  { content:"."; }
  50%  { content:".."; }
  75%  { content:"..."; }
  100% { content:""; }
}

/* =========================================================
   CALENDAR MODAL
   ========================================================= */
.cal-modal {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  padding:16px;
  z-index:100;
}
.cal-modal.open {
  display:flex;
}
.cal-dialog {
  background:#111;
  color:var(--text-primary);
  width:min(500px,100%);
  max-height:90vh;
  overflow:auto;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 30px 70px rgba(0,0,0,.7);
  padding:16px;
  position:relative;
  font-size:14px;
}
.cal-close {
  position:absolute;
  top:8px;
  right:8px;
  background:#1f1f1f;
  border:0;
  color:var(--text-primary);
  border-radius:8px;
  cursor:pointer;
  line-height:1;
  padding:6px 8px;
  font-size:12px;
}
.cal-inline {
  min-height:400px;
}
.cal-fallback-wrap {
  font-size:13px;
  margin-top:12px;
}
.cal-fallback-wrap a {
  color:var(--accent);
  text-decoration:underline;
}

/* =========================================================
   RESPONSIVE
   ========================================================= */
@media(max-width:600px){
  .hero-headline {
    font-size:28px;
  }
  .composer-bar {
    border-radius:20px;
  }
  .msg {
    max-width:90%;
    font-size:14px;
  }
}
